(()=>{var t={n:r=>{var o=r&&r.__esModule?()=>r.default:()=>r;return t.d(o,{a:o}),o},d:(r,o)=>{for(var e in o)t.o(o,e)&&!t.o(r,e)&&Object.defineProperty(r,e,{enumerable:!0,get:o[e]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r)};(()=>{"use strict";const r=flarum.core.compat["common/app"];t.n(r)().initializers.add("shebaoting/repost",(function(){console.log("[shebaoting/repost] Hello, forum and admin!")}));const o=flarum.core.compat["forum/app"];var e=t.n(o);const n=flarum.core.compat["common/extend"],a=flarum.core.compat["forum/components/DiscussionComposer"];var i=t.n(a);const s=flarum.core.compat["forum/components/DiscussionListItem"];var l=t.n(s);const c=flarum.core.compat["forum/components/EditPostComposer"];var u=t.n(c);const p=flarum.core.compat["forum/components/DiscussionPage"];var f=t.n(p);const d=flarum.core.compat["models/Discussion"];var g=t.n(d);const v=flarum.core.compat["common/Model"];var b=t.n(v);function h(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,e=Array(r);o<r;o++)e[o]=t[o];return e}e().initializers.add("shebaoting-repost",(function(){console.log("[shebaoting/repost] Hello, forum!"),function(){function t(t){var r=t.content.match(/^(https?:\/\/[^\s]+)/);if(console.log("Matched URL:",r),t.attributes=t.attributes||{},r){var o=r[0];t.attributes.originalUrl=o,console.log("Original URL set:",o)}else t.attributes.originalUrl="",console.log("Original URL cleared")}(0,n.extend)(i().prototype,"data",(function(r){t(r)})),(0,n.extend)(u().prototype,"data",(function(r){t(r)})),(0,n.extend)(l().prototype,"infoItems",(function(t){var r=this.attrs.discussion.attribute("original_url");if(r)try{var o=new URL(r).hostname;t.add("originalUrl",m("span",{className:"item-terminalPost"},o),-10)}catch(t){console.error("Invalid URL:",r)}})),(0,n.extend)(l().prototype,"view",(function(t){var r=this.attrs.discussion.attribute("original_url");if(r){var o=function(t){if(!t)return null;for(var r,e=function(t,r){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(o)return(o=o.call(t)).next.bind(o);if(Array.isArray(t)||(o=function(t,r){if(t){if("string"==typeof t)return h(t,r);var o={}.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?h(t,r):void 0}}(t))||r&&t&&"number"==typeof t.length){o&&(t=o);var e=0;return function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(t);!(r=e()).done;){var n=r.value;if(n&&n.tag&&n.attrs&&"DiscussionListItem-title"===n.attrs.className)return n;if(n&&n.children){var a=o(n.children);if(a)return a}}return null},e=o(t.children);e&&(e.attrs.onclick=function(t){return t.preventDefault(),t.stopPropagation(),window.open(r,"_blank","noopener"),!1})}return t})),g().prototype.originalUrl=b().attribute("original_url"),(0,n.extend)(f().prototype,"onupdate",(function(){var t=this.discussion;if(t&&t.originalUrl()&&t.originalUrl()){var r=document.createElement("div");r.className="OriginalUrlNotice",r.innerHTML="\n          <p>"+app.translator.trans("shebaoting-repost.forum.notice_message")+"</p>\n        ";var o=this.$(".PostStream-item:first-child .Post-body")[0];o&&!this.$(".OriginalUrlNotice").length&&o.parentNode.insertBefore(r,o.nextSibling)}}))}()}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map